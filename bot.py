import asyncio
import logging
import random
import os
import requests
import tempfile
from datetime import datetime, timedelta
from telegram import Bot, InputMediaPhoto
from telegram.error import TelegramError
from telegram.request import HTTPXRequest
import schedule
import time
from threading import Thread
from bs4 import BeautifulSoup
from PIL import Image
import io
import httpx
import signal
import sys

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞
BOT_TOKEN = os.getenv("BOT_TOKEN", "8437007902:AAFXbYzoWZI7lmg4EvF3DcopKXwbzYQgpkI")
CHANNEL_ID = os.getenv("CHANNEL_ID", "-1002722697999")  # –í–∞—à –∫–∞–Ω–∞–ª
PIXABAY_API_KEY = os.getenv("PIXABAY_API_KEY")
UNSPLASH_API_KEY = os.getenv("UNSPLASH_API_KEY")
PEXELS_API_KEY = os.getenv("PEXELS_API_KEY")

class WorkBot:
    def __init__(self):
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTP –∫–ª–∏–µ–Ω—Ç–∞ —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏ –¥–ª—è Railway
        request = HTTPXRequest(
            connection_pool_size=50,  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø—É–ª–∞
            pool_timeout=60,          # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –ø—É–ª–∞
            read_timeout=60,          # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç —á—Ç–µ–Ω–∏—è
            write_timeout=60,         # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –∑–∞–ø–∏—Å–∏
            connect_timeout=60,       # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            http_version="1.1"        # –ò—Å–ø–æ–ª—å–∑—É–µ–º HTTP/1.1 –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        )
        self.bot = Bot(token=BOT_TOKEN, request=request)
        self.last_keywords = []
        
        # –ë–∞–∑–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç (–±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
        self.work_verbs = [
            "–ü–æ–∫—Ä–∞—Å–∏—Ç—å", "–ü–æ–º—ã—Ç—å", "–£–±—Ä–∞—Ç—å", "–ü–æ–∫–æ—Å–∏—Ç—å", "–ü–æ—Å–∏–¥–µ—Ç—å", 
            "–†–∞–∑–æ–±—Ä–∞—Ç—å", "–ü–æ–∫–æ—Ä–º–∏—Ç—å", "–ü–æ—á–∏—Å—Ç–∏—Ç—å", "–ü–æ–∫–ª–µ–∏—Ç—å", "–ü–æ–≤–µ—Å–∏—Ç—å",
            "–°–æ–±—Ä–∞—Ç—å", "–†–∞–∑–ª–æ–∂–∏—Ç—å", "–ü–µ—Ä–µ—Å—Ç–∞–≤–∏—Ç—å", "–û—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å", "–ü–æ—á–∏–Ω–∏—Ç—å",
            "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å", "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å", "–ü—Ä–æ—Å—É—à–∏—Ç—å", "–ü—Ä–æ–≥—Ä–µ—Ç—å", "–û—Ö–ª–∞–¥–∏—Ç—å",
            "–ó–∞–≥—Ä—É–∑–∏—Ç—å", "–í—ã–≥—Ä—É–∑–∏—Ç—å", "–ü–µ—Ä–µ–≤–µ–∑—Ç–∏", "–î–æ—Å—Ç–∞–≤–∏—Ç—å", "–ó–∞–±—Ä–∞—Ç—å",
            "–ü—Ä–∏–Ω–µ—Å—Ç–∏", "–û—Ç–Ω–µ—Å—Ç–∏", "–ü–æ–¥–Ω—è—Ç—å", "–û–ø—É—Å—Ç–∏—Ç—å", "–ü–æ–≤–µ—Ä–Ω—É—Ç—å",
            "–°–¥–≤–∏–Ω—É—Ç—å", "–ü–µ—Ä–µ–¥–≤–∏–Ω—É—Ç—å", "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å", "–°–Ω—è—Ç—å", "–ó–∞–∫—Ä–µ–ø–∏—Ç—å",
            "–û—Ç–∫—Ä–µ–ø–∏—Ç—å", "–°–æ–µ–¥–∏–Ω–∏—Ç—å", "–†–∞–∑—ä–µ–¥–∏–Ω–∏—Ç—å", "–í–∫–ª—é—á–∏—Ç—å", "–í—ã–∫–ª—é—á–∏—Ç—å",
            "–û—Ç–∫—Ä—ã—Ç—å", "–ó–∞–∫—Ä—ã—Ç—å", "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å", "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å", "–ó–∞—â–∏—Ç–∏—Ç—å"
        ]
        
        self.work_objects = [
            "–∑–∞–±–æ—Ä", "–¥–æ–º", "–º–∞—à–∏–Ω—É", "–æ–∫–Ω–∞", "–ø–æ–ª—ã", "—Å—Ç–µ–Ω—ã", "–¥–≤–µ—Ä–∏", 
            "–∫—Ä—ã—à—É", "–ø–æ–¥–≤–∞–ª", "—á–µ—Ä–¥–∞–∫", "–±–∞–ª–∫–æ–Ω", "–ª–µ—Å—Ç–Ω–∏—Ü—É", "–≤–æ—Ä–æ—Ç–∞",
            "–∫–∞–ª–∏—Ç–∫—É", "–∑–∞–±–æ—Ä—á–∏–∫", "–ª–∞–≤–æ—á–∫—É", "—Å–∫–∞–º–µ–π–∫—É", "–ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫",
            "–ª—é—Å—Ç—Ä—É", "–∑–µ—Ä–∫–∞–ª–∞", "–º–µ–±–µ–ª—å", "—Ç–µ—Ö–Ω–∏–∫—É", "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã", "–æ–¥–µ–∂–¥—É",
            "–æ–±—É–≤—å", "–ø–æ—Å—É–¥—É", "–∫–æ–≤—Ä—ã", "—à—Ç–æ—Ä—ã", "–∂–∞–ª—é–∑–∏", "—Ä–∞–¥–∏–∞—Ç–æ—Ä—ã",
            "—Ç—Ä—É–±—ã", "–∫—Ä–∞–Ω—ã", "—Ä–æ–∑–µ—Ç–∫–∏", "–≤—ã–∫–ª—é—á–∞—Ç–µ–ª–∏", "–ª–∞–º–ø–æ—á–∫–∏", "–ø—Ä–æ–≤–æ–¥–∞",
            "–∫–∞–±–µ–ª–∏", "–∞–Ω—Ç–µ–Ω–Ω—É", "—Å–ø—É—Ç–Ω–∏–∫–æ–≤—É—é —Ç–∞—Ä–µ–ª–∫—É", "–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä", "–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä",
            "–ø–µ—á—å", "–∫–∞–º–∏–Ω", "–¥—É—Ö–æ–≤–∫—É", "–º–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫—É", "—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫", "—Å—Ç–∏—Ä–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É",
            "–ø–æ—Å—É–¥–æ–º–æ–π–∫—É", "–ø—ã–ª–µ—Å–æ—Å", "—É—Ç—é–≥", "—Ñ–µ–Ω", "–±—Ä–∏—Ç–≤—É", "—ç–ª–µ–∫—Ç—Ä–æ–±—Ä–∏—Ç–≤—É",
            "—Ç–µ–ª–µ—Ñ–æ–Ω", "–∫–æ–º–ø—å—é—Ç–µ—Ä", "–ø—Ä–∏–Ω—Ç–µ—Ä", "—Å–∫–∞–Ω–µ—Ä", "—Ä–æ—É—Ç–µ—Ä", "–º–æ–¥–µ–º",
            "—Ç–µ–ª–µ–≤–∏–∑–æ—Ä", "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä", "–∫–æ–ª–æ–Ω–∫–∏", "–Ω–∞—É—à–Ω–∏–∫–∏", "–∫–∞–º–µ—Ä—É",
            "—Ñ–æ—Ç–æ–∞–ø–ø–∞—Ä–∞—Ç", "–≤–∏–¥–µ–æ–∫–∞–º–µ—Ä—É", "–ø—Ä–æ–µ–∫—Ç–æ—Ä", "—ç–∫—Ä–∞–Ω", "–¥–æ—Å–∫—É", "–ø–ª–∞–∫–∞—Ç—ã",
            "–∫–∞—Ä—Ç–∏–Ω—ã", "—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏", "—Ä–∞–º–∫–∏", "–≤–∞–∑—ã", "—Å—Ç–∞—Ç—É—ç—Ç–∫–∏", "—Å—É–≤–µ–Ω–∏—Ä—ã",
            "–∫–Ω–∏–≥–∏", "–∂—É—Ä–Ω–∞–ª—ã", "–≥–∞–∑–µ—Ç—ã", "–¥–æ–∫—É–º–µ–Ω—Ç—ã", "–ø–∞–ø–∫–∏", "—Ñ–∞–π–ª—ã",
            "–¥–∏—Å–∫–∏", "—Ñ–ª–µ—à–∫–∏", "–∫–∞—Ä—Ç—ã –ø–∞–º—è—Ç–∏", "–±–∞—Ç–∞—Ä–µ–π–∫–∏", "–∑–∞—Ä—è–¥–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞",
            "–∫–∞–±–µ–ª–∏ –∑–∞—Ä—è–¥–∫–∏", "–∞–¥–∞–ø—Ç–µ—Ä—ã", "–ø–µ—Ä–µ—Ö–æ–¥–Ω–∏–∫–∏", "—Ä–∞–∑–≤–µ—Ç–≤–∏—Ç–µ–ª–∏", "—É–¥–ª–∏–Ω–∏—Ç–µ–ª–∏",
            "—Ñ–∏–ª—å—Ç—Ä—ã", "–∫–∞—Ä—Ç—Ä–∏–¥–∂–∏", "—Ç–æ–Ω–µ—Ä", "–±—É–º–∞–≥—É", "—Ä—É—á–∫–∏", "–∫–∞—Ä–∞–Ω–¥–∞—à–∏",
            "–º–∞—Ä–∫–µ—Ä—ã", "—Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã", "–∫—Ä–∞—Å–∫–∏", "–∫–∏—Å—Ç–∏", "–≤–∞–ª–∏–∫–∏", "—à–ø–∞—Ç–µ–ª–∏",
            "–æ—Ç–≤–µ—Ä—Ç–∫–∏", "–∫–ª—é—á–∏", "–º–æ–ª–æ—Ç–∫–∏", "–≥–≤–æ–∑–¥–∏", "—à—É—Ä—É–ø—ã", "–±–æ–ª—Ç—ã", "–≥–∞–π–∫–∏",
            "—à–∞–π–±—ã", "–ø—Ä–æ–∫–ª–∞–¥–∫–∏", "–≥–µ—Ä–º–µ—Ç–∏–∫", "–∫–ª–µ–π", "—Å–∫–æ—Ç—á", "–∏–∑–æ–ª–µ–Ω—Ç—É",
            "–ø—Ä–æ–≤–æ–ª–æ–∫—É", "–≤–µ—Ä–µ–≤–∫—É", "—à–Ω—É—Ä", "—Ü–µ–ø—å", "—Ç—Ä–æ—Å", "–∫–∞–Ω–∞—Ç", "–ª–µ—Å–∫—É",
            "—Å–µ—Ç—å", "—Ç–∫–∞–Ω—å", "–ø–ª–µ–Ω–∫—É", "—Ñ–æ–ª—å–≥—É", "–±—É–º–∞–≥—É", "–∫–∞—Ä—Ç–æ–Ω", "–ø–µ–Ω–æ–ø–ª–∞—Å—Ç",
            "–ø–æ—Ä–æ–ª–æ–Ω", "–≤–∞—Ç–∞", "–≤–∞—Ç–∞", "—Å–∏–Ω—Ç–µ–ø–æ–Ω", "–ø—É—Ö", "–ø–µ—Ä—å—è", "—à–µ—Ä—Å—Ç—å",
            "–º–µ—Ö", "–∫–æ–∂—É", "–∑–∞–º—à—É", "–≤–µ–ª—é—Ä", "–±–∞—Ä—Ö–∞—Ç", "–∞—Ç–ª–∞—Å", "—à–µ–ª–∫",
            "—Ö–ª–æ–ø–æ–∫", "–ª–µ–Ω", "—à–µ—Ä—Å—Ç—å", "–∫–∞—à–µ–º–∏—Ä", "–∞–Ω–≥–æ—Ä–∞", "–º–æ—Ö–µ—Ä", "–∞–ª—å–ø–∞–∫–∞",
            "–≤–µ—Ä–±–ª—é–∂—å—è —à–µ—Ä—Å—Ç—å", "—è–∫", "–ª–∞–º–∞", "–≤–∏–∫—É–Ω—å—è", "–≥—É–∞–Ω–∞–∫–æ", "—Å—É—Ä–æ–∫",
            "–±–æ–±—Ä", "–Ω–æ—Ä–∫–∞", "—Å–æ–±–æ–ª—å", "–∫—É–Ω–∏—Ü–∞", "–≥–æ—Ä–Ω–æ—Å—Ç–∞–π", "–ª–∞—Å–∫–∞", "—Ö–æ—Ä–µ–∫",
            "–µ–Ω–æ—Ç", "–ª–∏—Å–∞", "–≤–æ–ª–∫", "–º–µ–¥–≤–µ–¥—å", "—Ç–∏–≥—Ä", "–ª–µ–æ–ø–∞—Ä–¥", "—è–≥—É–∞—Ä",
            "–ø—É–º–∞", "—Ä—ã—Å—å", "–∫–∞—Ä–∞–∫–∞–ª", "—Å–µ—Ä–≤–∞–ª", "–æ—Ü–µ–ª–æ—Ç", "–º–∞—Ä–≥–∞–π", "–æ–Ω—Ü–∏–ª–ª–∞",
            "–∫–æ—Ç", "–∫–æ—à–∫–∞", "–∫–æ—Ç–µ–Ω–æ–∫", "–∫–æ—Ç–µ–Ω–æ–∫", "–∫–æ—Ç–µ–Ω–æ–∫", "–∫–æ—Ç–µ–Ω–æ–∫", "–∫–æ—Ç–µ–Ω–æ–∫"
        ]
        
        self.work_locations = [
            "–≤ –¥–æ–º–µ", "–≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ", "–≤ –æ—Ñ–∏—Å–µ", "–≤ –º–∞–≥–∞–∑–∏–Ω–µ", "–≤ –∫–∞—Ñ–µ", "–≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ",
            "–≤ —à–∫–æ–ª–µ", "–≤ –±–æ–ª—å–Ω–∏—Ü–µ", "–≤ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–µ", "–≤ –∞–ø—Ç–µ–∫–µ", "–≤ –±–∞–Ω–∫–µ", "–≤ –ø–æ—á—Ç–µ",
            "–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ", "–≤ –º—É–∑–µ–µ", "–≤ —Ç–µ–∞—Ç—Ä–µ", "–≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–µ", "–≤ —Å–ø–æ—Ä—Ç–∑–∞–ª–µ",
            "–≤ –±–∞—Å—Å–µ–π–Ω–µ", "–≤ —Å–∞—É–Ω–µ", "–≤ –±–∞–Ω–µ", "–≤ –≥–∞—Ä–∞–∂–µ", "–≤ –ø–æ–¥–≤–∞–ª–µ", "–Ω–∞ —á–µ—Ä–¥–∞–∫–µ",
            "–Ω–∞ –±–∞–ª–∫–æ–Ω–µ", "–Ω–∞ –ª–æ–¥–∂–∏–∏", "–Ω–∞ —Ç–µ—Ä—Ä–∞—Å–µ", "–Ω–∞ –≤–µ—Ä–∞–Ω–¥–µ", "–≤ —Å–∞–¥—É", "–≤ –æ–≥–æ—Ä–æ–¥–µ",
            "–≤ –ø–∞—Ä–∫–µ", "–≤–æ –¥–≤–æ—Ä–µ", "–Ω–∞ —É–ª–∏—Ü–µ", "–Ω–∞ –¥–æ—Ä–æ–≥–µ", "–Ω–∞ —Ç—Ä–æ—Ç—É–∞—Ä–µ", "–Ω–∞ –ø–ª–æ—â–∞–¥–∏",
            "–Ω–∞ —Å—Ç–∞–¥–∏–æ–Ω–µ", "–Ω–∞ –∞—Ä–µ–Ω–µ", "–Ω–∞ —Å—Ü–µ–Ω–µ", "–Ω–∞ –ø–æ–¥–∏—É–º–µ", "–Ω–∞ —Ç—Ä–∏–±—É–Ω–µ", "–Ω–∞ —Å–∫–∞–º–µ–π–∫–µ",
            "–Ω–∞ –ª–∞–≤–æ—á–∫–µ", "–Ω–∞ —Å—Ç—É–ª–µ", "–Ω–∞ –∫—Ä–µ—Å–ª–µ", "–Ω–∞ –¥–∏–≤–∞–Ω–µ", "–Ω–∞ –∫—Ä–æ–≤–∞—Ç–∏", "–Ω–∞ –º–∞—Ç—Ä–∞—Å–µ",
            "–Ω–∞ –ø–æ–¥—É—à–∫–µ", "–Ω–∞ –æ–¥–µ—è–ª–µ", "–Ω–∞ –ø—Ä–æ—Å—Ç—ã–Ω–µ", "–Ω–∞ –Ω–∞–≤–æ–ª–æ—á–∫–µ", "–Ω–∞ –ø–æ–¥–æ–¥–µ—è–ª—å–Ω–∏–∫–µ",
            "–Ω–∞ –ø–æ–∫—Ä—ã–≤–∞–ª–µ", "–Ω–∞ –ø–ª–µ–¥", "–Ω–∞ –∫–æ–≤—Ä–µ", "–Ω–∞ –ø–∞–ª–∞—Å–µ", "–Ω–∞ –ª–∏–Ω–æ–ª–µ—É–º–µ", "–Ω–∞ –ø–∞—Ä–∫–µ—Ç–µ",
            "–Ω–∞ –ª–∞–º–∏–Ω–∞—Ç–µ", "–Ω–∞ –ø–ª–∏—Ç–∫–µ", "–Ω–∞ –º—Ä–∞–º–æ—Ä–µ", "–Ω–∞ –≥—Ä–∞–Ω–∏—Ç–µ", "–Ω–∞ –±–µ—Ç–æ–Ω–µ", "–Ω–∞ –∞—Å—Ñ–∞–ª—å—Ç–µ",
            "–Ω–∞ –∑–µ–º–ª–µ", "–Ω–∞ —Ç—Ä–∞–≤–µ", "–Ω–∞ –ø–µ—Å–∫–µ", "–Ω–∞ –∫–∞–º–Ω—è—Ö", "–Ω–∞ –≥–∞–ª—å–∫–µ", "–Ω–∞ —â–µ–±–Ω–µ",
            "–Ω–∞ –≥—Ä–∞–≤–∏–∏", "–Ω–∞ –≥–ª–∏–Ω–µ", "–Ω–∞ –∏–ª–µ", "–Ω–∞ –≥—Ä—è–∑–∏", "–Ω–∞ —Å–Ω–µ–≥—É", "–Ω–∞ –ª—å–¥—É",
            "–Ω–∞ –≤–æ–¥–µ", "–Ω–∞ —Ä–µ–∫–µ", "–Ω–∞ –æ–∑–µ—Ä–µ", "–Ω–∞ –º–æ—Ä–µ", "–Ω–∞ –æ–∫–µ–∞–Ω–µ", "–Ω–∞ –ø—Ä—É–¥—É",
            "–Ω–∞ –±–æ–ª–æ—Ç–µ", "–Ω–∞ –ª—É–≥—É", "–Ω–∞ –ø–æ–ª–µ", "–Ω–∞ –≥–æ—Ä–µ", "–Ω–∞ —Ö–æ–ª–º–µ", "–Ω–∞ —Å–∫–ª–æ–Ω–µ",
            "–Ω–∞ –≤–µ—Ä—à–∏–Ω–µ", "–Ω–∞ –¥–Ω–µ", "–Ω–∞ –¥–Ω–µ", "–Ω–∞ –¥–Ω–µ", "–Ω–∞ –¥–Ω–µ", "–Ω–∞ –¥–Ω–µ"
        ]
        
        self.work_conditions = [
            "–æ—Ç –≥—Ä—è–∑–∏", "–æ—Ç –ø—ã–ª–∏", "–æ—Ç –º—É—Å–æ—Ä–∞", "–æ—Ç –ª–∏—Å—Ç—å–µ–≤", "–æ—Ç —Å–Ω–µ–≥–∞", "–æ—Ç –ª—å–¥–∞",
            "–æ—Ç —Ä–∂–∞–≤—á–∏–Ω—ã", "–æ—Ç –Ω–∞–∫–∏–ø–∏", "–æ—Ç –∂–∏—Ä–∞", "–æ—Ç –∫–æ–ø–æ—Ç–∏", "–æ—Ç —Å–∞–∂–∏", "–æ—Ç –∫–ª–µ—è",
            "–æ—Ç –∫—Ä–∞—Å–∫–∏", "–æ—Ç –ª–∞–∫–∞", "–æ—Ç –≤–æ—Å–∫–∞", "–æ—Ç –º–∞—Å–ª–∞", "–æ—Ç –±–µ–Ω–∑–∏–Ω–∞", "–æ—Ç —Å–æ–ª—è—Ä–∫–∏",
            "–æ—Ç –∫–µ—Ä–æ—Å–∏–Ω–∞", "–æ—Ç –∞—Ü–µ—Ç–æ–Ω–∞", "–æ—Ç —Å–ø–∏—Ä—Ç–∞", "–æ—Ç —É–∫—Å—É—Å–∞", "–æ—Ç —Å–æ–ª–∏", "–æ—Ç —Å–∞—Ö–∞—Ä–∞",
            "–æ—Ç –º–µ–¥–∞", "–æ—Ç –≤–∞—Ä–µ–Ω—å—è", "–æ—Ç –¥–∂–µ–º–∞", "–æ—Ç —Å–∏—Ä–æ–ø–∞", "–æ—Ç —Å–æ—É—Å–∞", "–æ—Ç –∫–µ—Ç—á—É–ø–∞",
            "–æ—Ç –º–∞–π–æ–Ω–µ–∑–∞", "–æ—Ç –≥–æ—Ä—á–∏—Ü—ã", "–æ—Ç —Ö—Ä–µ–Ω–∞", "–æ—Ç –ø–µ—Ä—Ü–∞", "–æ—Ç —Å–ø–µ—Ü–∏–π", "–æ—Ç —Ç—Ä–∞–≤",
            "–æ—Ç —Ü–≤–µ—Ç–æ–≤", "–æ—Ç —Ñ—Ä—É–∫—Ç–æ–≤", "–æ—Ç –æ–≤–æ—â–µ–π", "–æ—Ç —è–≥–æ–¥", "–æ—Ç –≥—Ä–∏–±–æ–≤", "–æ—Ç –æ—Ä–µ—Ö–æ–≤",
            "–æ—Ç —Å–µ–º–µ—á–µ–∫", "–æ—Ç –∑–µ—Ä–µ–Ω", "–æ—Ç –∫—Ä—É–ø—ã", "–æ—Ç –º—É–∫–∏", "–æ—Ç —Å–∞—Ö–∞—Ä–∞", "–æ—Ç —Å–æ–ª–∏",
            "–æ—Ç —Å–æ–¥—ã", "–æ—Ç –¥—Ä–æ–∂–∂–µ–π", "–æ—Ç –∑–∞–∫–≤–∞—Å–∫–∏", "–æ—Ç –∫–µ—Ñ–∏—Ä–∞", "–æ—Ç –π–æ–≥—É—Ä—Ç–∞", "–æ—Ç —Ç–≤–æ—Ä–æ–≥–∞",
            "–æ—Ç —Å—ã—Ä–∞", "–æ—Ç –º–∞—Å–ª–∞", "–æ—Ç –º–∞—Ä–≥–∞—Ä–∏–Ω–∞", "–æ—Ç —Å–∞–ª–∞", "–æ—Ç –º—è—Å–∞", "–æ—Ç —Ä—ã–±—ã",
            "–æ—Ç –ø—Ç–∏—Ü—ã", "–æ—Ç —è–∏—Ü", "–æ—Ç –º–æ–ª–æ–∫–∞", "–æ—Ç —Å–ª–∏–≤–æ–∫", "–æ—Ç —Å–º–µ—Ç–∞–Ω—ã", "–æ—Ç –º–∞–π–æ–Ω–µ–∑–∞",
            "–æ—Ç –∫–µ—Ç—á—É–ø–∞", "–æ—Ç —Å–æ—É—Å–∞", "–æ—Ç –ø–æ–¥–ª–∏–≤—ã", "–æ—Ç –±—É–ª—å–æ–Ω–∞", "–æ—Ç —Å—É–ø–∞", "–æ—Ç –±–æ—Ä—â–∞",
            "–æ—Ç —â–µ–π", "–æ—Ç —Ä–∞—Å—Å–æ–ª—å–Ω–∏–∫–∞", "–æ—Ç —Å–æ–ª—è–Ω–∫–∏", "–æ—Ç —É—Ö–∏", "–æ—Ç —Ö–∞—Ä—á–æ", "–æ—Ç –ª–∞–≥–º–∞–Ω–∞",
            "–æ—Ç –ø–ª–æ–≤–∞", "–æ—Ç —à–∞—à–ª—ã–∫–∞", "–æ—Ç —à–∞—É—Ä–º—ã", "–æ—Ç –±—É—Ä–≥–µ—Ä–∞", "–æ—Ç –ø–∏—Ü—Ü—ã", "–æ—Ç –ø–∞—Å—Ç—ã",
            "–æ—Ç —Ä–∏—Å–∞", "–æ—Ç –≥—Ä–µ—á–∫–∏", "–æ—Ç –ø–µ—Ä–ª–æ–≤–∫–∏", "–æ—Ç –ø—à–µ–Ω–∞", "–æ—Ç –æ–≤—Å—è–Ω–∫–∏", "–æ—Ç –º–∞–Ω–∫–∏",
            "–æ—Ç –∫—É–∫—É—Ä—É–∑—ã", "–æ—Ç –≥–æ—Ä–æ—Ö–∞", "–æ—Ç —Ñ–∞—Å–æ–ª–∏", "–æ—Ç —á–µ—á–µ–≤–∏—Ü—ã", "–æ—Ç –Ω—É—Ç–∞", "–æ—Ç –º–∞—à–∞",
            "–æ—Ç —Å–æ–∏", "–æ—Ç –∞—Ä–∞—Ö–∏—Å–∞", "–æ—Ç –º–∏–Ω–¥–∞–ª—è", "–æ—Ç –≥—Ä–µ—Ü–∫–∏—Ö –æ—Ä–µ—Ö–æ–≤", "–æ—Ç —Ñ—É–Ω–¥—É–∫–∞", "–æ—Ç –∫–µ—à—å—é",
            "–æ—Ç —Ñ–∏—Å—Ç–∞—à–µ–∫", "–æ—Ç –∫–µ–¥—Ä–æ–≤—ã—Ö –æ—Ä–µ—Ö–æ–≤", "–æ—Ç –±—Ä–∞–∑–∏–ª—å—Å–∫–∏—Ö –æ—Ä–µ—Ö–æ–≤", "–æ—Ç –º–∞–∫–∞–¥–∞–º–∏–∏", "–æ—Ç –ø–µ–∫–∞–Ω–∞", "–æ—Ç –æ—Ä–µ—Ö–æ–≤ –ø–µ–∫–∞–Ω"
        ]
        
        self.prices = [
            "1000‚ÇΩ", "1200‚ÇΩ", "1500‚ÇΩ", "1800‚ÇΩ", "2000‚ÇΩ", 
            "2300‚ÇΩ", "2500‚ÇΩ", "2800‚ÇΩ", "3000‚ÇΩ", "3500‚ÇΩ",
            "4000‚ÇΩ", "4300‚ÇΩ", "4500‚ÇΩ", "5000‚ÇΩ",
            "1.000‚ÇΩ", "1.200‚ÇΩ", "1.500‚ÇΩ", "1.800‚ÇΩ", "2.000‚ÇΩ",
            "2.300‚ÇΩ", "2.500‚ÇΩ", "2.800‚ÇΩ", "3.000‚ÇΩ", "3.500‚ÇΩ",
            "4.000‚ÇΩ", "4.300‚ÇΩ", "4.500‚ÇΩ", "5.000‚ÇΩ"
        ]
        
        self.bonuses = [
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è", 
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "—Ç–∞–∫—Å–∏ —Å –º–µ–Ω—è",
            "–æ–±–µ–¥", 
            "–æ–±–µ–¥ –±–æ—Ä—â", 
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –±—É –∫–ª–µ–π",
            "–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –¥–∞—é",
            "–º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–∞—é",
            "—á–∞–π —Å –ø–µ—á–µ–Ω—å–∫–∞–º–∏",
            "–∫–æ—Ñ–µ —Å –±—É–ª–æ—á–∫–æ–π",
            "–æ–±–µ–¥ + —á–∞–π",
            "–º–∞—Ç–µ—Ä–∏–∞–ª—ã + –æ–±–µ–¥",
            "—Ç–∞–∫—Å–∏ + –æ–±–µ–¥",
            "–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å + –æ–±–µ–¥",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç",
            "–æ–±–µ–¥ + –¥–µ—Å–µ—Ä—Ç",
            "–º–∞—Ç–µ—Ä–∏–∞–ª—ã + —Ç–∞–∫—Å–∏",
            "—á–∞–π + –ø–µ—á–µ–Ω—å–∫–∏",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞–±–æ—Ä –¥—é–±–µ–ª–µ–π",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –±–æ–ª–≥–∞—Ä–∫–∞",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –¥—Ä–µ–ª—å",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞–±–æ—Ä –∫–ª—é—á–µ–π",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –º–æ–ª–æ—Ç–æ–∫",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –æ—Ç–≤–µ—Ä—Ç–∫–∏",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –ø–ª–æ—Å–∫–æ–≥—É–±—Ü—ã",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –Ω–æ–∂–æ–≤–∫—É",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –ª–æ–ø–∞—Ç—É",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –≥—Ä–∞–±–ª–∏",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ –≤–µ–¥—Ä–æ",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ —Ç—Ä—è–ø–∫–∏",
            "–≤ –ø–æ–¥–∞—Ä–æ–∫ —à–≤–∞–±—Ä—É"
        ]
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å—Ç–∏–ª–µ –ø—Ä–∏–º–µ—Ä–æ–≤
        self.extra_info = [
            "–∑–∞ –ø–∞—Ä—É —á–∞—Å–æ–≤",
            "–Ω–∞ —Ä—É–∫–∏",
            "–ö–æ—Å–∏–ª–∫–∞ –µ—Å—Ç—å",
            "–ú–µ—Å—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã",
            "—Ç–∞–∫ –∂–µ —Å—Ç–æ–∏—Ç —à–≤–µ—Ü–∫–∏–π —Å—Ç–æ–ª",
            "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∞–º",
            "–º–∞—Ç–µ—Ä–∏–∞–ª—ã –µ—Å—Ç—å",
            "–±—ã—Å—Ç—Ä–æ —Å–¥–µ–ª–∞—Ç—å",
            "—Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–æ",
            "–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å–≤–æ–π",
            "–≤—Å–µ –¥–∞—é",
            "–±—ã—Å—Ç—Ä–æ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ",
            "–æ–ø—ã—Ç –Ω–µ –≤–∞–∂–µ–Ω",
            "–≥–ª–∞–≤–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ",
            "–∑–∞ –¥–µ–Ω—å —Å–¥–µ–ª–∞–µ–º",
            "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—é",
            "–≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –µ—Å—Ç—å",
            "—Ä–∞–±–æ—Ç–∞ –ª–µ–≥–∫–∞—è",
            "–¥–µ–Ω—å–≥–∏ —Å—Ä–∞–∑—É",
            "–Ω–∞–ª–∏—á–Ω—ã–º–∏"
        ]
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–∫–∞–∫ –æ—Ç —Ä–∞–±–æ—Ç—è–≥–∏)
        self.quirky_additions = [
            "P.S. –ó–∞–±–æ—Ä –∫—Ä–∞—Å–∏—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ",
            "P.S. –ë–∞–±—É—à–∫–∞ –≤–æ—Ä—á–∏—Ç –Ω–æ –Ω–µ –∑–ª–∞—è",
            "P.S. –ö—Ä—ã–ª—å—Ü–æ –æ—Ç–º—ã—Ç—å –¥–æ –±–ª–µ—Å–∫–∞",
            "P.S. –î–æ–º –ø–æ–º—ã—Ç—å —Ö–æ—Ä–æ—à–æ",
            "P.S. –°–Ω–µ–≥ —É–±–∏—Ä–∞—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ",
            "P.S. –ú–∞—à–∏–Ω—É –ø–æ–º—ã—Ç—å –¥–æ –±–ª–µ—Å–∫–∞",
            "P.S. –¢—Ä–∞–≤—É –∫–æ—Å–∏—Ç—å —Ä–æ–≤–Ω–æ",
            "P.S. –°—Ç–µ–Ω—ã –∫—Ä–∞—Å–∏—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ",
            "P.S. –ú—É—Å–æ—Ä —É–±–∏—Ä–∞—Ç—å –≤–µ—Å—å",
            "P.S. –û–∫–Ω–∞ –ø–æ–º—ã—Ç—å —á–∏—Å—Ç–æ",
            "P.S. –í–æ—Ä–æ—Ç–∞ –ø–æ–∫—Ä–∞—Å–∏—Ç—å —Ö–æ—Ä–æ—à–æ",
            "P.S. –õ–∏—Å—Ç—å—è —É–±—Ä–∞—Ç—å –≤—Å–µ",
            "P.S. –ü–æ–ª—ã –ø–æ–º—ã—Ç—å –¥–æ –±–ª–µ—Å–∫–∞",
            "P.S. –ó–∞–±–æ—Ä—á–∏–∫ –ø–æ–∫—Ä–∞—Å–∏—Ç—å —Ä–æ–≤–Ω–æ",
            "P.S. –°–Ω–µ–≥ —É–±–∏—Ä–∞—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ",
            "P.S. –ü–æ—Å—É–¥—É –ø–æ–º—ã—Ç—å —á–∏—Å—Ç–æ",
            "P.S. –õ–∞–≤–æ—á–∫—É –ø–æ–∫—Ä–∞—Å–∏—Ç—å —Ö–æ—Ä–æ—à–æ",
            "P.S. –ú—É—Å–æ—Ä —É–±—Ä–∞—Ç—å –≤–µ—Å—å",
            "P.S. –î–≤–µ—Ä–∏ –ø–æ–º—ã—Ç—å –¥–æ –±–ª–µ—Å–∫–∞",
            "P.S. –ö–∞–ª–∏—Ç–∫—É –ø–æ–∫—Ä–∞—Å–∏—Ç—å —Ä–æ–≤–Ω–æ"
        ]

    def generate_work_type(self):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π —Ç–∏–ø —Ä–∞–±–æ—Ç—ã (–±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)"""
        # 30% —à–∞–Ω—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
        if random.random() < 0.3:
            special_works = [
                "–ù–∞–±–∏—Ä–∞–µ–º –º–∞—Å—Å–æ–≤–∫—É –¥–ª—è —Å—ä–µ–º–æ–∫",
                "–ó–∞—á–∏—Å—Ç–∏—Ç—å —É—á–∞—Å—Ç–æ–∫ –æ—Ç –±—É—Ä—å—è–Ω–∞", 
                "–†–∞–∑–æ–±—Ä–∞—Ç—å —Å—Ç—É–ø–µ–Ω—å–∫–∏ –Ω–∞ –∫—Ä—ã–ª—å—Ü–µ",
                "–ü–æ—Å–∏–¥–µ—Ç—å —Å –±–∞–±—É—à–∫–æ–π",
                "–ü–æ–∫–æ—Ä–º–∏—Ç—å –∫–æ—Ç–∞",
                "–ü–æ–º—ã—Ç—å –≤–µ–ª–æ—Å–∏–ø–µ–¥",
                "–£–±—Ä–∞—Ç—å –ø–∞—É—Ç–∏–Ω—É —Å –ø–æ—Ç–æ–ª–∫–∞",
                "–ü–æ–∫—Ä–∞—Å–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫",
                "–£–±—Ä–∞—Ç—å –ø—ã–ª—å —Å –∫–Ω–∏–≥",
                "–ü–æ–º—ã—Ç—å –ª—é—Å—Ç—Ä—É",
                "–ü–æ–∫—Ä–∞—Å–∏—Ç—å –ª–µ—Å—Ç–Ω–∏—Ü—É",
                "–£–±—Ä–∞—Ç—å –º—É—Å–æ—Ä –∏–∑ —Å–∞—Ä–∞—è",
                "–ü–æ–º—ã—Ç—å –ø–æ–ª –≤ –≥–∞—Ä–∞–∂–µ",
                "–ü–æ–∫—Ä–∞—Å–∏—Ç—å —Ç—Ä—É–±—ã",
                "–£–±—Ä–∞—Ç—å —Å–Ω–µ–≥ —Å –∫—Ä—ã—à–∏ –≥–∞—Ä–∞–∂–∞",
                "–ü–æ–º—ã—Ç—å –∑–∞–±–æ—Ä",
                "–ü–æ–∫—Ä–∞—Å–∏—Ç—å –¥–≤–µ—Ä—å –≤ –ø–æ–¥—ä–µ–∑–¥"
            ]
            return random.choice(special_works)
        
        # 70% —à–∞–Ω—Å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Ä–∞–±–æ—Ç—É
        verb = random.choice(self.work_verbs)
        obj = random.choice(self.work_objects)
        
        # 40% —à–∞–Ω—Å –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ
        if random.random() < 0.4:
            condition = random.choice(self.work_conditions)
            work = f"{verb} {obj} {condition}"
        else:
            work = f"{verb} {obj}"
        
        # 30% —à–∞–Ω—Å –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é
        if random.random() < 0.3:
            location = random.choice(self.work_locations)
            work += f" {location}"
        
        return work

    def generate_message(self):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–∏–ª–µ –ø—Ä–∏–º–µ—Ä–æ–≤ (–±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è)"""
        work = self.generate_work_type()
        price = random.choice(self.prices)
        bonus = random.choice(self.bonuses)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–∏–ª–µ –ø—Ä–∏–º–µ—Ä–æ–≤
        message = f"{work}, {price} {bonus}"

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –î–û –∏—Å–∫–∞–∂–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        self.last_keywords = self.extract_keywords_from_work(work)
        
        # 40% —à–∞–Ω—Å –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        if random.random() < 0.4:
            extra = random.choice(self.extra_info)
            message += f", {extra}"
        
        # –î–æ–±–∞–≤–ª—è–µ–º –±–µ–∑–≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
        message = self.add_typos(message)
        
        # –î–µ–ª–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç —Å –º–∞–ª–µ–Ω—å–∫–æ–π –±—É–∫–≤—ã
        message = self.make_lowercase(message)
        
        return message

    def extract_keywords_from_work(self, work: str):
        """–í—ã–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞-–ø—Ä–µ–¥–º–µ—Ç—ã –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–∑—ã —Ä–∞–±–æ—Ç—ã –¥–ª—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π."""
        try:
            text = work.lower()
            # –£–¥–∞–ª—è–µ–º –∑–∞–ø—è—Ç—ã–µ/–ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã
            for ch in [",", ".", "!", "?", ":", ";"]:
                text = text.replace(ch, " ")
            tokens = [t for t in text.split() if t]
            
            # –°—Ç–æ–ø-—Å–ª–æ–≤–∞
            stop = {
                "–≤", "–≤–æ", "–Ω–∞", "–Ω–∞–¥", "–ø–æ–¥", "–∏–∑", "–æ—Ç", "–¥–æ", "–∑–∞", "–ø–æ", "–¥–ª—è",
                "–∏", "–∏–ª–∏", "–∫", "—Å", "—É", "–æ", "–æ–±", "–ø—Ä–æ", "—á—Ç–æ", "–∫–∞–∫",
                "–¥–Ω—è", "—É—Ç—Ä–∞", "–≤–µ—á–µ—Ä–∞", "–Ω–æ—á—å—é", "–Ω–æ—á—å", "–¥–Ω–µ–º", "–¥–µ–Ω—å", "–¥–æ–º–∞",
                "–≥—Ä—è–∑–∏", "–ø—ã–ª–∏", "–º—É—Å–æ—Ä–∞", "–ª–∏—Å—Ç—å–µ–≤", "—Å–Ω–µ–≥–∞", "–ª—å–¥–∞", "—Ä–∂–∞–≤—á–∏–Ω—ã"
            }
            
            # –°–ª–æ–≤–∞—Ä—å –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
            object_keywords = {
                # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
                "–æ—Ç–≤–µ—Ä—Ç–∫–∏": "screwdriver", "–æ—Ç–≤–µ—Ä—Ç–∫–∞": "screwdriver", "–∫–ª—é—á–µ–π": "wrench", "–∫–ª—é—á–∏": "wrench",
                "–º–æ–ª–æ—Ç–æ–∫": "hammer", "–º–æ–ª–æ—Ç–∫–∏": "hammer", "–ø–ª–æ—Å–∫–æ–≥—É–±—Ü—ã": "pliers", "–Ω–æ–∂–æ–≤–∫—É": "saw",
                "–Ω–æ–∂–æ–≤–∫–∞": "saw", "–¥—Ä–µ–ª—å": "drill", "–ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä": "drill", "–±–æ–ª–≥–∞—Ä–∫–∞": "grinder",
                "–ª–æ–ø–∞—Ç—É": "shovel", "–ª–æ–ø–∞—Ç–∞": "shovel", "–≥—Ä–∞–±–ª–∏": "rake", "–≤–µ–¥—Ä–æ": "bucket",
                "—à–≤–∞–±—Ä—É": "mop", "—à–≤–∞–±—Ä–∞": "mop", "—Ç—Ä—è–ø–∫–∏": "rag", "—Ç—Ä—è–ø–∫–∞": "rag",
                
                # –ü—Ä–µ–¥–º–µ—Ç—ã –º–µ–±–µ–ª–∏/–∏–Ω—Ç–µ—Ä—å–µ—Ä–∞
                "—Å–∫–∞–º–µ–π–∫—É": "bench", "—Å–∫–∞–º–µ–π–∫–∞": "bench", "–ª–∞–≤–æ—á–∫—É": "bench", "–ª–∞–≤–æ—á–∫–∞": "bench",
                "—Å—Ç—É–ª": "chair", "—Å—Ç—É–ª—å—è": "chair", "–∫—Ä–µ—Å–ª–æ": "chair", "–∫—Ä–µ—Å–ª–∞": "chair",
                "–¥–∏–≤–∞–Ω": "sofa", "–¥–∏–≤–∞–Ω—ã": "sofa", "–∫—Ä–æ–≤–∞—Ç—å": "bed", "–∫—Ä–æ–≤–∞—Ç–∏": "bed",
                "—Å—Ç–æ–ª": "table", "—Å—Ç–æ–ª—ã": "table", "—à–∫–∞—Ñ": "wardrobe", "—à–∫–∞—Ñ—ã": "wardrobe",
                
                # –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã/–æ–±—ä–µ–∫—Ç—ã
                "–∑–∞–±–æ—Ä": "fence", "–∑–∞–±–æ—Ä—á–∏–∫": "fence", "–≤–æ—Ä–æ—Ç–∞": "gate", "–∫–∞–ª–∏—Ç–∫—É": "gate",
                "–∫–∞–ª–∏—Ç–∫–∞": "gate", "–ª–µ—Å—Ç–Ω–∏—Ü—É": "stairs", "–ª–µ—Å—Ç–Ω–∏—Ü–∞": "stairs", "–∫—Ä—ã—à—É": "roof",
                "–∫—Ä—ã—à–∞": "roof", "—Å—Ç–µ–Ω—ã": "wall", "—Å—Ç–µ–Ω–∞": "wall", "–ø–æ–ª—ã": "floor", "–ø–æ–ª": "floor",
                "–æ–∫–Ω–∞": "window", "–æ–∫–Ω–æ": "window", "–¥–≤–µ—Ä–∏": "door", "–¥–≤–µ—Ä—å": "door",
                
                # –¢–µ—Ö–Ω–∏–∫–∞
                "–º–∞—à–∏–Ω—É": "car", "–º–∞—à–∏–Ω–∞": "car", "–≤–µ–ª–æ—Å–∏–ø–µ–¥": "bicycle", "–≤–µ–ª–∞—Å–∏–ø–µ–¥": "bicycle",
                "—Ç–µ–ª–µ–≤–∏–∑–æ—Ä": "tv", "–∫–æ–º–ø—å—é—Ç–µ—Ä": "computer", "—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫": "refrigerator",
                "—Å—Ç–∏—Ä–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É": "washing machine", "–ø–æ—Å—É–¥–æ–º–æ–π–∫—É": "dishwasher",
                
                # –î—Ä—É–≥–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                "–ø–æ—Å—É–¥—É": "dishes", "–ø–æ—Å—É–¥–∞": "dishes", "–∫–æ–≤—Ä—ã": "carpet", "–∫–æ–≤–µ—Ä": "carpet",
                "—à—Ç–æ—Ä—ã": "curtains", "—à—Ç–æ—Ä–∞": "curtains", "–ª—é—Å—Ç—Ä—É": "chandelier", "–ª—é—Å—Ç—Ä–∞": "chandelier",
                "–∑–µ—Ä–∫–∞–ª–∞": "mirror", "–∑–µ—Ä–∫–∞–ª–æ": "mirror", "–∫–Ω–∏–≥–∏": "books", "–∫–Ω–∏–≥–∞": "books"
            }
            
            keywords = []
            
            # –ò—â–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã –≤ —Ç–µ–∫—Å—Ç–µ
            for tok in tokens:
                if tok in object_keywords and tok not in keywords:
                    keywords.append(object_keywords[tok])
                    if len(keywords) >= 2:  # –ú–∞–∫—Å–∏–º—É–º 2 –ø—Ä–µ–¥–º–µ—Ç–∞
                        break
            
            # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø—Ä–µ–¥–º–µ—Ç—ã, –∏—â–µ–º –æ–±—â–∏–µ —Å–ª–æ–≤–∞
            if not keywords:
                for tok in tokens:
                    if tok not in stop and tok.isalpha() and len(tok) > 3:
                        keywords.append(tok)
                        if len(keywords) >= 2:
                            break
            
            return keywords[:2]  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∞–∫—Å–∏–º—É–º 2 –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤–∞
            
        except Exception:
            return []
    
    def add_typos(self, text):
        """–î–æ–±–∞–≤–ª—è–µ—Ç –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–£–Æ –±–µ–∑–≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å –∫–∞–∫ —É –æ—á–µ–Ω—å –Ω–µ–≥—Ä–∞–º–æ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞"""
        # –°–ª–æ–≤–∞—Ä—å –∑–∞–º–µ–Ω –¥–ª—è –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ô –±–µ–∑–≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏
        replacements = {
            "–ü–æ–∫—Ä–∞—Å–∏—Ç—å": "–ü–∞–∫—Ä–∞—Å–∏—Ç—å",
            "–ü–æ–º—ã—Ç—å": "–ü–∞–º—ã–π—Ç—å", 
            "–£–±—Ä–∞—Ç—å": "–£–±—Ä–∞—Ç—å",
            "–ü–æ–∫–æ—Å–∏—Ç—å": "–ü–∞–∫–æ—Å–∏—Ç—å",
            "–ü–æ—Å–∏–¥–µ—Ç—å": "–ü–∞—Å–∏–¥–µ—Ç—å",
            "–†–∞–∑–æ–±—Ä–∞—Ç—å": "–†–∞–∑–æ–±—Ä–∞—Ç—å",
            "–ü–æ–∫–æ—Ä–º–∏—Ç—å": "–ü–∞–∫–æ—Ä–º–∏—Ç—å",
            "—Ç–∞–∫—Å–∏": "—Ç–∞–∫—Å–∏",
            "–æ–±–µ–¥": "–æ–±–µ–¥",
            "–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å": "–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å",
            "–º–∞—Ç–µ—Ä–∏–∞–ª—ã": "–º–∞—Ç—ë—Ä–∏–∞–ª—ã",
            "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç": "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç",
            "–¥—é–±–µ–ª–µ–π": "–¥—é–±–µ–ª—ë–π",
            "–ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä": "–ø–µ—Ä—Ñ–∞—Ä–∞—Ç–æ—Ä",
            "–±–æ–ª–≥–∞—Ä–∫–∞": "–±–æ–ª–≥–∞—Ä–∫–∞",
            "–¥—Ä–µ–ª—å": "–¥—Ä–µ–ª—å",
            "–∫–ª—é—á–µ–π": "–∫–ª—é—á—ë–π",
            "–º–æ–ª–æ—Ç–æ–∫": "–º–æ–ª–æ—Ç–æ–∫",
            "–æ—Ç–≤–µ—Ä—Ç–∫–∏": "–æ—Ç–≤—ë—Ä—Ç–∫–∏",
            "–ø–ª–æ—Å–∫–æ–≥—É–±—Ü—ã": "–ø–ª–æ—Å–∫–æ–≥—É–±—Ü—ã",
            "–Ω–æ–∂–æ–≤–∫—É": "–Ω–æ–∂–æ–≤–∫—É",
            "–ª–æ–ø–∞—Ç—É": "–ª–æ–ø–∞—Ç—É",
            "–≥—Ä–∞–±–ª–∏": "–≥—Ä–∞–±–ª–∏",
            "–≤–µ–¥—Ä–æ": "–≤–µ–¥—Ä–æ",
            "—Ç—Ä—è–ø–∫–∏": "—Ç—Ä—è–ø–∫–∏",
            "—à–≤–∞–±—Ä—É": "—à–≤–∞–±—Ä—É",
            "–∑–∞–±–æ—Ä": "–∑–∞–±–æ—Ä",
            "–±–∞–±—É—à–∫–æ–π": "–±–∞–±—É—à–∫–æ–π",
            "–∫—Ä—ã–ª—å—Ü–æ": "–∫—Ä—ã–ª—å—Ü–æ",
            "–º—É—Å–æ—Ä–∞": "–º—É—Å–æ—Ä–∞",
            "–¥–æ–º": "–¥–æ–º",
            "–≥—Ä—è–∑–∏": "–≥—Ä—è–∑–∏",
            "—Å–Ω–µ–≥": "—Å–Ω—ë–≥",
            "–∫—Ä—ã—à–∏": "–∫—Ä—ã—à–π",
            "–º–∞—à–∏–Ω—É": "–º–∞—à–∏–Ω—É",
            "—Ç—Ä–∞–≤—É": "—Ç—Ä–∞–≤—É",
            "—Å—Ç–µ–Ω—ã": "—Å—Ç–µ–Ω—ã",
            "—É—á–∞—Å—Ç–∫–µ": "—É—á–∞—Å—Ç–∫–µ",
            "–æ–∫–Ω–∞": "–æ–∫–Ω–∞",
            "–≤–æ—Ä–æ—Ç–∞": "–≤–æ—Ä–æ—Ç–∞",
            "–ª–∏—Å—Ç—å—è": "–ª–∏—Å—Ç—å—è",
            "–ø–æ–ª—ã": "–ø–æ–ª—ã",
            "–∑–∞–±–æ—Ä—á–∏–∫": "–∑–∞–±–æ—Ä—á–∏–∫",
            "–¥–æ—Ä–æ–∂–µ–∫": "–¥–æ—Ä–æ–∂–µ–∫",
            "–ø–æ—Å—É–¥—É": "–ø–æ—Å—É–¥—É",
            "–ª–∞–≤–æ—á–∫—É": "–ª–∞–≤–æ—á–∫—É",
            "–ø–æ–¥–≤–∞–ª–µ": "–ø–æ–¥–≤–∞–ª–µ",
            "–¥–≤–µ—Ä–∏": "–¥–≤–µ—Ä–∏",
            "–∫–∞–ª–∏—Ç–∫—É": "–∫–∞–ª–∏—Ç–∫—É",
            "–∫–æ—Ç–∞": "–∫–æ—Ç–∞",
            "–≤–µ–ª–æ—Å–∏–ø–µ–¥": "–≤–µ–ª–∞—Å–∏–ø–µ–¥",
            "—Å–∫–∞–º–µ–π–∫—É": "—Å–∫–∞–º–µ–π–∫—É",
            "–ø–∞—É—Ç–∏–Ω—É": "–ø–∞—É—Ç–∏–Ω—É",
            "–ø–æ—Ç–æ–ª–∫–∞": "–ø–æ—Ç–æ–ª–∫–∞",
            "–∑–µ—Ä–∫–∞–ª–∞": "–∑–µ—Ä–∫–∞–ª–∞",
            "–ø–æ—á—Ç–æ–≤—ã–π": "–ø–æ—á—Ç–æ–≤—ã–π",
            "—è—â–∏–∫": "—è—â–∏–∫",
            "–ø—ã–ª—å": "–ø—ã–ª—å",
            "–∫–Ω–∏–≥": "–∫–Ω–∏–≥",
            "–ª—é—Å—Ç—Ä—É": "–ª—é—Å—Ç—Ä—É",
            "–ª–µ—Å—Ç–Ω–∏—Ü—É": "–ª–µ—Å—Ç–Ω–∏—Ü—É",
            "—Å–∞—Ä–∞—è": "—Å–∞—Ä–∞—è",
            "–≥–∞—Ä–∞–∂–µ": "–≥–∞—Ä–∞–∂–µ",
            "—Ç—Ä—É–±—ã": "—Ç—Ä—É–±–∏",
            "–ø–æ–¥—ä–µ–∑–¥": "–ø–æ–¥—ä–µ–∑–¥"
        }
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–º–µ–Ω—ã —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 70% (–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –±–µ–∑–≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å)
        for correct, wrong in replacements.items():
            if random.random() < 0.7:
                text = text.replace(correct, wrong)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û —Å–ª—É—á–∞–π–Ω—ã–µ –æ–ø–µ—á–∞—Ç–∫–∏
        if random.random() < 0.6:
            text = text.replace("–∏", "–π", 1)
        if random.random() < 0.5:
            text = text.replace("–µ", "—ë", 1)
        if random.random() < 0.4:
            text = text.replace("–æ", "–∞", 1)
        if random.random() < 0.35:
            text = text.replace("—ã", "–∏", 1)
        if random.random() < 0.3:
            text = text.replace("—É", "—é", 1)
        if random.random() < 0.25:
            text = text.replace("–∞", "–æ", 1)
        if random.random() < 0.2:
            text = text.replace("—ë", "–µ", 1)
        if random.random() < 0.15:
            text = text.replace("–π", "–∏", 1)
            
        return text

    def make_lowercase(self, text):
        """–î–µ–ª–∞–µ—Ç –≤–µ—Å—å —Ç–µ–∫—Å—Ç —Å –º–∞–ª–µ–Ω—å–∫–æ–π –±—É–∫–≤—ã"""
        return text.lower()

    def search_churka_image(self):
        """–§–æ–ª–ª–±–µ–∫: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –¥–∞–≥–µ—Å—Ç–∞–Ω—Ü–∞–º–∏, —Ç–∞–¥–∂–∏–∫–∞–º–∏ –∏ –ø–æ–¥–æ–±–Ω—ã–º–∏."""
        try:
            # –ì–æ—Ç–æ–≤—ã–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –Ω—É–∂–Ω—ã–º–∏ –ª—é–¥—å–º–∏
            ethnic_people_urls = [
                # Unsplash - —Ä–∞–±–æ—á–∏–µ, —Å—Ç—Ä–æ–∏—Ç–µ–ª–∏, –º–∏–≥—Ä–∞–Ω—Ç—ã
                "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=400&h=400&fit=crop&crop=face",
                "https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=400&h=400&fit=crop&crop=face",
                # Picsum —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ ID –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
                "https://picsum.photos/400/400?random=300",
                "https://picsum.photos/400/400?random=301", 
                "https://picsum.photos/400/400?random=302",
                "https://picsum.photos/400/400?random=303",
                "https://picsum.photos/400/400?random=304",
                "https://picsum.photos/400/400?random=305",
                "https://picsum.photos/400/400?random=306",
                "https://picsum.photos/400/400?random=307",
                "https://picsum.photos/400/400?random=308",
                "https://picsum.photos/400/400?random=309",
                "https://picsum.photos/400/400?random=310"
            ]
            
            selected_url = random.choice(ethnic_people_urls)
            logger.info(f"–í—ã–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (fallback —Å –¥–∞–≥–µ—Å—Ç–∞–Ω—Ü–µ–º/—Ç–∞–¥–∂–∏–∫–æ–º): {selected_url}")
            return selected_url
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
            return None

    def fetch_unsplash_image(self, keywords):
        """–ò—â–µ—Ç –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ Unsplash –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –∏–∑ —Ç–µ–∫—Å—Ç–∞."""
        try:
            if not UNSPLASH_API_KEY:
                return None
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞-–ø—Ä–µ–¥–º–µ—Ç—ã, –∏—â–µ–º –∏—Ö
            if keywords:
                for keyword in keywords:
                    try:
                        url = f"https://api.unsplash.com/search/photos"
                        headers = {"Authorization": f"Client-ID {UNSPLASH_API_KEY}"}
                        params = {
                            "query": keyword,
                            "per_page": 20,
                            "orientation": "all"
                        }
                        resp = requests.get(url, headers=headers, params=params, timeout=10)
                        resp.raise_for_status()
                        data = resp.json()
                        results = data.get("results", [])
                        if results:
                            result = random.choice(results)
                            image_url = result.get("urls", {}).get("regular")
                            if image_url:
                                logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ '{keyword}' –Ω–∞ Unsplash: {image_url}")
                                return image_url
                    except Exception as e:
                        logger.warning(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ '{keyword}' –Ω–∞ Unsplash: {e}")
                        continue
            
            # –§–æ–ª–ª–±–µ–∫: –ø–æ–∏—Å–∫ —Ä–∞–±–æ—á–∏—Ö/—Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π
            fallback_queries = [
                "construction worker", "migrant worker", "laborer", "manual worker", "dirty worker",
                "construction man", "worker face", "laborer face", "manual labor", "dirty man"
            ]
            
            for query in fallback_queries:
                try:
                    url = f"https://api.unsplash.com/search/photos"
                    headers = {"Authorization": f"Client-ID {UNSPLASH_API_KEY}"}
                    params = {
                        "query": query,
                        "per_page": 20,
                        "orientation": "portrait"
                    }
                    resp = requests.get(url, headers=headers, params=params, timeout=10)
                    resp.raise_for_status()
                    data = resp.json()
                    results = data.get("results", [])
                    if results:
                        result = random.choice(results)
                        image_url = result.get("urls", {}).get("regular")
                        if image_url:
                            logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}': {image_url}")
                            return image_url
                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}': {e}")
                    continue
            
            logger.warning("–ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ Unsplash")
            return None
            
        except Exception as e:
            logger.warning(f"Unsplash –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É: {e}")
            return None

    def fetch_pexels_image(self, keywords):
        """–ò—â–µ—Ç –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ Pexels –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –∏–∑ —Ç–µ–∫—Å—Ç–∞."""
        try:
            if not PEXELS_API_KEY:
                return None
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞-–ø—Ä–µ–¥–º–µ—Ç—ã, –∏—â–µ–º –∏—Ö
            if keywords:
                for keyword in keywords:
                    try:
                        url = f"https://api.pexels.com/v1/search"
                        headers = {"Authorization": PEXELS_API_KEY}
                        params = {
                            "query": keyword,
                            "per_page": 20,
                            "orientation": "all"
                        }
                        resp = requests.get(url, headers=headers, params=params, timeout=10)
                        resp.raise_for_status()
                        data = resp.json()
                        photos = data.get("photos", [])
                        if photos:
                            photo = random.choice(photos)
                            image_url = photo.get("src", {}).get("medium")
                            if image_url:
                                logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ '{keyword}' –Ω–∞ Pexels: {image_url}")
                                return image_url
                    except Exception as e:
                        logger.warning(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ '{keyword}' –Ω–∞ Pexels: {e}")
                        continue
            
            # –§–æ–ª–ª–±–µ–∫: –ø–æ–∏—Å–∫ —Ä–∞–±–æ—á–∏—Ö/—Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π
            fallback_queries = [
                "construction worker", "migrant worker", "laborer", "manual worker", "dirty worker",
                "construction man", "worker face", "laborer face", "manual labor", "dirty man"
            ]
            
            for query in fallback_queries:
                try:
                    url = f"https://api.pexels.com/v1/search"
                    headers = {"Authorization": PEXELS_API_KEY}
                    params = {
                        "query": query,
                        "per_page": 20,
                        "orientation": "portrait"
                    }
                    resp = requests.get(url, headers=headers, params=params, timeout=10)
                    resp.raise_for_status()
                    data = resp.json()
                    photos = data.get("photos", [])
                    if photos:
                        photo = random.choice(photos)
                        image_url = photo.get("src", {}).get("medium")
                        if image_url:
                            logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}': {image_url}")
                            return image_url
                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}': {e}")
                    continue
            
            logger.warning("–ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ Pexels")
            return None
            
        except Exception as e:
            logger.warning(f"Pexels –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É: {e}")
            return None

    def fetch_pixabay_image(self, keywords):
        """–ò—â–µ—Ç –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ Pixabay –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –∏–∑ —Ç–µ–∫—Å—Ç–∞."""
        try:
            if not PIXABAY_API_KEY:
                return None
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞-–ø—Ä–µ–¥–º–µ—Ç—ã, –∏—â–µ–º –∏—Ö
            if keywords:
                for keyword in keywords:
                    try:
                        # –ó–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –Ω–∞ + –¥–ª—è Pixabay
                        query = keyword.replace(" ", "+")
                        url = (
                            f"https://pixabay.com/api/?key={PIXABAY_API_KEY}"
                            f"&q={query}&image_type=photo&lang=en&safesearch=true&per_page=20&orientation=all"
                        )
                        resp = requests.get(url, timeout=10)
                        resp.raise_for_status()
                        data = resp.json()
                        hits = data.get("hits", [])
                        if hits:
                            hit = random.choice(hits)
                            image_url = hit.get("webformatURL") or hit.get("largeImageURL")
                            if image_url:
                                logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ '{keyword}' –Ω–∞ Pixabay: {image_url}")
                                return image_url
                    except Exception as e:
                        logger.warning(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ '{keyword}' –Ω–∞ Pixabay: {e}")
                        continue
            
            # –§–æ–ª–ª–±–µ–∫: –ø–æ–∏—Å–∫ —Ä–∞–±–æ—á–∏—Ö/—Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π
            fallback_queries = [
                "dirty+worker", "construction+worker", "migrant+worker", "laborer", "manual+worker",
                "dirty+man", "construction+man", "worker+face", "laborer+face", "manual+labor"
            ]
            
            for query in fallback_queries:
                try:
                    url = (
                        f"https://pixabay.com/api/?key={PIXABAY_API_KEY}"
                        f"&q={query}&image_type=photo&lang=en&safesearch=true&per_page=20&orientation=horizontal"
                    )
                    resp = requests.get(url, timeout=10)
                    resp.raise_for_status()
                    data = resp.json()
                    hits = data.get("hits", [])
                    if hits:
                        hit = random.choice(hits)
                        image_url = hit.get("webformatURL") or hit.get("largeImageURL")
                        if image_url:
                            logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}': {image_url}")
                            return image_url
                except Exception as e:
                    logger.warning(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}': {e}")
                    continue
            
            logger.warning("–ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ Pixabay")
            return None
            
        except Exception as e:
            logger.warning(f"Pixabay –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É: {e}")
            return None

    def get_image_for_message(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç URL –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –∏–∑ —Ç–µ–∫—Å—Ç–∞."""
        # –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        
        # 1. Unsplash (–ª—É—á—à–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
        url = self.fetch_unsplash_image(self.last_keywords)
        if url:
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ Unsplash –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º {self.last_keywords}: {url}")
            return url
        
        # 2. Pexels (—Ö–æ—Ä–æ—à–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫)
        url = self.fetch_pexels_image(self.last_keywords)
        if url:
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ Pexels –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º {self.last_keywords}: {url}")
            return url
        
        # 3. Pixabay (—Ä–µ–∑–µ—Ä–≤)
        url = self.fetch_pixabay_image(self.last_keywords)
        if url:
            logger.info(f"–ù–∞–π–¥–µ–Ω–æ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ Pixabay –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º {self.last_keywords}: {url}")
            return url
        
        # 4. –§–æ–ª–ª–±–µ–∫: –≤—Å–µ–≥–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –¥–∞–≥–µ—Å—Ç–∞–Ω—Ü–∞–º–∏/—Ç–∞–¥–∂–∏–∫–∞–º–∏
        fallback_url = self.search_churka_image()
        if fallback_url:
            logger.info(f"–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –¥–∞–≥–µ—Å—Ç–∞–Ω—Ü–µ–º/—Ç–∞–¥–∂–∏–∫–æ–º: {fallback_url}")
            return fallback_url
        
        # 5. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑–µ—Ä–≤ - —Å–ª—É—á–∞–π–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        logger.warning("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑–µ—Ä–≤ - —Å–ª—É—á–∞–π–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ")
        return "https://picsum.photos/400/400?random=999"

    def download_image(self, image_url):
        """–°–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ URL"""
        try:
            headers = {
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
            }
            
            response = requests.get(image_url, headers=headers, timeout=15)
            response.raise_for_status()
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–Ω–µ –±–æ–ª—å—à–µ 5MB)
            if len(response.content) > 5 * 1024 * 1024:
                logger.warning("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                return None
            
            # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
            temp_file = tempfile.NamedTemporaryFile(delete=False, suffix='.jpg')
            temp_file.write(response.content)
            temp_file.close()
            
            logger.info(f"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∫–∞—á–∞–Ω–æ: {temp_file.name}")
            return temp_file.name
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
            return None

    async def send_message_to_channel(self):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏"""
        message = self.generate_message()
        max_retries = 5  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
        
        for attempt in range(max_retries):
            try:
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç —Å —Ç–∞–π–º–∞—É—Ç–æ–º
                await asyncio.wait_for(
                    self.bot.send_message(chat_id=CHANNEL_ID, text=message),
                    timeout=30  # 30 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É
                )
                logger.info(f"‚úÖ –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {message}")
                return
                    
            except asyncio.TimeoutError:
                logger.error(f"‚è∞ –¢–∞–π–º–∞—É—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ (–ø–æ–ø—ã—Ç–∫–∞ {attempt + 1})")
                if attempt < max_retries - 1:
                    await asyncio.sleep(min(2 ** attempt, 30))  # –ú–∞–∫—Å–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥ –∑–∞–¥–µ—Ä–∂–∫–∏
                continue
            except Exception as e:
                error_msg = str(e)
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ (–ø–æ–ø—ã—Ç–∫–∞ {attempt + 1}): {error_msg}")
                
                # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –æ—à–∏–±–æ–∫ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
                if "Pool timeout" in error_msg or "connection pool" in error_msg.lower():
                    logger.warning("üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫—É")
                    if attempt < max_retries - 1:
                        await asyncio.sleep(min(5 * (2 ** attempt), 60))  # –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—É–ª–∞
                    continue
                
                # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –æ—à–∏–±–æ–∫ event loop
                if "Event loop is closed" in error_msg:
                    logger.warning("üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ event loop")
                    if attempt < max_retries - 1:
                        await asyncio.sleep(10)  # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
                    continue
                
                if attempt < max_retries - 1:
                    await asyncio.sleep(min(2 ** attempt, 30))  # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º
                else:
                    logger.error(f"üíÄ –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ {max_retries} –ø–æ–ø—ã—Ç–æ–∫: {message}")
                    # –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ —Å –Ω–æ–≤—ã–º bot instance
                    try:
                        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π bot instance –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ø—ã—Ç–∫–∏
                        new_request = HTTPXRequest(
                            connection_pool_size=10,
                            pool_timeout=30,
                            read_timeout=30,
                            write_timeout=30,
                            connect_timeout=30
                        )
                        emergency_bot = Bot(token=BOT_TOKEN, request=new_request)
                        await asyncio.wait_for(
                            emergency_bot.send_message(chat_id=CHANNEL_ID, text=message),
                            timeout=60
                        )
                        logger.info(f"üÜò –†–µ–∑–µ—Ä–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {message}")
                    except Exception as final_e:
                        logger.error(f"üíÄ –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: {final_e}")

    def send_message_sync(self):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º event loop"""
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∞–∫—Ç–∏–≤–Ω—ã–π event loop
            try:
                loop = asyncio.get_running_loop()
                # –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π loop, —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á—É
                import concurrent.futures
                with concurrent.futures.ThreadPoolExecutor() as executor:
                    future = executor.submit(self._run_in_new_loop)
                    future.result(timeout=120)  # 2 –º–∏–Ω—É—Ç—ã —Ç–∞–π–º–∞—É—Ç
            except RuntimeError:
                # –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ loop, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
                self._run_in_new_loop()
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ send_message_sync: {e}")
            # –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ —Å –ø—Ä–æ—Å—Ç—ã–º asyncio.run
            try:
                asyncio.run(self.send_message_to_channel())
            except Exception as e2:
                logger.error(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ send_message_sync: {e2}")
    
    def _run_in_new_loop(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–º event loop"""
        loop = asyncio.new_event_loop()
        asyncio.set_event_loop(loop)
        try:
            loop.run_until_complete(self.send_message_to_channel())
        finally:
            # –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º loop
            try:
                # –û—Ç–º–µ–Ω—è–µ–º –≤—Å–µ pending –∑–∞–¥–∞—á–∏
                pending = asyncio.all_tasks(loop)
                for task in pending:
                    task.cancel()
                if pending:
                    loop.run_until_complete(asyncio.gather(*pending, return_exceptions=True))
            except Exception:
                pass
            finally:
                loop.close()

    def schedule_messages(self):
        """–ü–ª–∞–Ω–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π 10 —Ä–∞–∑ –≤ –¥–µ–Ω—å"""
        # 7:00 —É—Ç—Ä–∞
        schedule.every().day.at("07:00").do(self.send_message_sync)
        # 9:00 —É—Ç—Ä–∞
        schedule.every().day.at("09:00").do(self.send_message_sync)
        # 11:00 —É—Ç—Ä–∞
        schedule.every().day.at("11:00").do(self.send_message_sync)
        # 13:00 –¥–Ω—è
        schedule.every().day.at("13:00").do(self.send_message_sync)
        # 15:00 –¥–Ω—è
        schedule.every().day.at("15:00").do(self.send_message_sync)
        # 17:00 –¥–Ω—è
        schedule.every().day.at("17:00").do(self.send_message_sync)
        # 19:00 –≤–µ—á–µ—Ä–∞
        schedule.every().day.at("19:00").do(self.send_message_sync)
        # 21:00 –≤–µ—á–µ—Ä–∞
        schedule.every().day.at("21:00").do(self.send_message_sync)
        # 23:00 –≤–µ—á–µ—Ä–∞
        schedule.every().day.at("23:00").do(self.send_message_sync)
        # 1:00 –Ω–æ—á–∏
        schedule.every().day.at("01:00").do(self.send_message_sync)
        
        logger.info("–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ: 07:00, 09:00, 11:00, 13:00, 15:00, 17:00, 19:00, 21:00, 23:00, 01:00")

    def run_scheduler(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"""
        while True:
            try:
                schedule.run_pending()
                time.sleep(60)  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ: {e}")
                time.sleep(60)  # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ

    async def start_bot(self):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞"""
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            me = await self.bot.get_me()
            logger.info(f"–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω: @{me.username}")
            
            # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
            self.schedule_messages()
            
            # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
            scheduler_thread = Thread(target=self.run_scheduler, daemon=True)
            scheduler_thread.start()
            
            logger.info("–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –≤ 07:00, 09:00, 11:00, 13:00, 15:00, 17:00, 19:00, 21:00, 23:00, 01:00")
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            logger.info("üöÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è...")
            
            try:
                await self.send_message_to_channel()
                logger.info("‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ 1 –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è 1: {e}")
            
            await asyncio.sleep(5)
            
            try:
                await self.send_message_to_channel()
                logger.info("‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ 2 –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è 2: {e}")
            
            await asyncio.sleep(5)
            
            try:
                await self.send_message_to_channel()
                logger.info("‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ 3 –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è 3: {e}")
            
            # –î–µ—Ä–∂–∏–º –±–æ—Ç–∞ –∞–∫—Ç–∏–≤–Ω—ã–º
            while True:
                await asyncio.sleep(3600)  # –°–ø–∏–º —á–∞—Å
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞: {e}")
            raise

def signal_handler(signum, frame):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è graceful shutdown"""
    logger.info(f"–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª {signum}, –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É...")
    sys.exit(0)

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –¥–ª—è Railway"""
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
    signal.signal(signal.SIGINT, signal_handler)
    signal.signal(signal.SIGTERM, signal_handler)
    
    bot = WorkBot()
    
    try:
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º event loop –¥–ª—è Railway
        if os.getenv("RAILWAY_ENVIRONMENT"):
            # –í Railway –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            asyncio.set_event_loop_policy(asyncio.DefaultEventLoopPolicy())
        
        asyncio.run(bot.start_bot())
    except KeyboardInterrupt:
        logger.info("–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        # –í Railway –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º—Å—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
        if os.getenv("RAILWAY_ENVIRONMENT"):
            logger.info("–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥...")
            time.sleep(30)
            main()  # –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

if __name__ == "__main__":
    main()
